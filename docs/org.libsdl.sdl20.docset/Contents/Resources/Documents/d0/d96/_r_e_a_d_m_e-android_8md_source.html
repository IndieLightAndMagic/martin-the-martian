<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SDL: README-android.md Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SDL
   &#160;<span id="projectnumber">2.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">README-android.md</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d0/d96/_r_e_a_d_m_e-android_8md.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Android</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;================================================================================</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Matt Styles wrote a tutorial on building SDL for Android with Visual Studio:</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;http://trederia.blogspot.de/2017/03/building-sdl2-for-android-with-visual.html</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;The rest of this README covers the Android gradle style build process.</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;If you are using the older ant build process, it is no longer officially</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;supported, but you can use the &quot;android-project-ant&quot; directory as a template.</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;================================================================================</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; Requirements</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;================================================================================</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;Android SDK (version 16 or later)</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;https://developer.android.com/sdk/index.html</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;Android NDK r10e or later</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;https://developer.android.com/tools/sdk/ndk/index.html</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;Minimum API level supported by SDL: 14 (Android 4.0.1)</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;================================================================================</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; How the port works</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;================================================================================</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;- Android applications are Java-based, optionally with parts written in C</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;- As SDL apps are C-based, we use a small Java shim that uses JNI to talk to </div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  the SDL library</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;- This means that your application C code must be placed inside an Android </div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  Java project, along with some C support code that communicates with Java</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;- This eventually produces a standard Android .apk package</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;The Android Java code implements an &quot;Activity&quot; and can be found in:</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;android-project/app/src/main/java/org/libsdl/app/SDLActivity.java</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;The Java code loads your game code, the SDL shared library, and</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;dispatches to native functions implemented in the SDL library:</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;src/core/android/SDL_android.c</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;================================================================================</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; Building an app</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;================================================================================</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;For simple projects you can use the script located at build-scripts/androidbuild.sh</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;There&#39;s two ways of using it:</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    androidbuild.sh com.yourcompany.yourapp &lt; sources.list</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    androidbuild.sh com.yourcompany.yourapp source1.c source2.c ...sourceN.c</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;sources.list should be a text file with a source file name in each line</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;Filenames should be specified relative to the current directory, for example if</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;you are in the build-scripts directory and want to create the testgles.c test, you&#39;ll</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;run:</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    ./androidbuild.sh org.libsdl.testgles ../test/testgles.c</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;One limitation of this script is that all sources provided will be aggregated into</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;a single directory, thus all your source files should have a unique name.</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;Once the project is complete the script will tell you where the debug APK is located.</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;If you want to create a signed release APK, you can use the project created by this</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;utility to generate it.</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;Finally, a word of caution: re running androidbuild.sh wipes any changes you may have</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;done in the build directory for the app!</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;For more complex projects, follow these instructions:</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    </div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;1. Copy the android-project directory wherever you want to keep your projects</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;   and rename it to the name of your project.</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;2. Move or symlink this SDL directory into the &quot;&lt;project&gt;/app/jni&quot; directory</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;3. Edit &quot;&lt;project&gt;/app/jni/src/Android.mk&quot; to include your source files</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;4. Run &#39;ndk-build&#39; (a script provided by the NDK). This compiles the C source</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;If you want to use Android Studio (recommended), skip to the Android Studio section below.</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;5. Run &#39;./gradlew installDebug&#39; in the project directory. This compiles the .java, creates an .apk with the native code embedded, and installs it on any connected Android device</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;Here&#39;s an explanation of the files in the Android project, so you can customize them:</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    android-project/app</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        build.gradle            - build info including the application version and SDK</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        src/main/AndroidManifest.xml       - package manifest. Among others, it contains the class name</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                             of the main Activity and the package name of the application.</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        jni/                       - directory holding native code</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        jni/Application.mk - Application JNI settings, including target platform and STL library</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        jni/Android.mk             - Android makefile that can call recursively the Android.mk files in all subdirectories</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        jni/SDL/           - (symlink to) directory holding the SDL library files</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        jni/SDL/Android.mk - Android makefile for creating the SDL shared library</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        jni/src/           - directory holding your C/C++ source</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        jni/src/Android.mk - Android makefile that you should customize to include your source code and any library references</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        src/main/assets/   - directory holding asset files for your application</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        src/main/res/              - directory holding resources for your application</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        src/main/res/mipmap-*      - directories holding icons for different phone hardware</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        src/main/res/values/strings.xml    - strings used in your application, including the application name</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        src/main/java/org/libsdl/app/SDLActivity.java - the Java class handling the initialization and binding to SDL. Be very careful changing this, as the SDL library relies on this implementation. You should instead subclass this for your application.</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;================================================================================</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; Customizing your application name</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;================================================================================</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;To customize your application name, edit AndroidManifest.xml and replace</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;&quot;org.libsdl.app&quot; with an identifier for your product package.</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;Then create a Java class extending SDLActivity and place it in a directory</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;under src matching your package, e.g.</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    src/com/gamemaker/game/MyGame.java</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;Here&#39;s an example of a minimal class file:</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    --- MyGame.java --------------------------</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    package com.gamemaker.game;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    </div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    import org.libsdl.app.SDLActivity; </div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    </div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    /**</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;     * A sample wrapper class that just calls SDLActivity </div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;     */ </div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    </div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    public class MyGame extends SDLActivity { }</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    </div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    ------------------------------------------</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;Then replace &quot;SDLActivity&quot; in AndroidManifest.xml with the name of your</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;class, .e.g. &quot;MyGame&quot;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;================================================================================</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; Customizing your application icon</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;================================================================================</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;Conceptually changing your icon is just replacing the &quot;ic_launcher.png&quot; files in</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;the drawable directories under the res directory. There are several directories</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;for different screen sizes.</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;================================================================================</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; Loading assets</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;================================================================================</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;Any files you put in the &quot;app/src/main/assets&quot; directory of your project</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;directory will get bundled into the application package and you can load</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;them using the standard functions in SDL_rwops.h.</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;There are also a few Android specific functions that allow you to get other</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;useful paths for saving and loading data:</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;* SDL_AndroidGetInternalStoragePath()</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;* SDL_AndroidGetExternalStorageState()</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;* SDL_AndroidGetExternalStoragePath()</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;See SDL_system.h for more details on these functions.</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;The asset packaging system will, by default, compress certain file extensions.</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;SDL includes two asset file access mechanisms, the preferred one is the so</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;called &quot;File Descriptor&quot; method, which is faster and doesn&#39;t involve the Dalvik</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;GC, but given this method does not work on compressed assets, there is also the</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;&quot;Input Stream&quot; method, which is automatically used as a fall back by SDL. You</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;may want to keep this fact in mind when building your APK, specially when large</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;files are involved.</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;For more information on which extensions get compressed by default and how to</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;disable this behaviour, see for example:</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    </div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;http://ponystyle.com/blog/2010/03/26/dealing-with-asset-compression-in-android-apps/</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;================================================================================</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; Pause / Resume behaviour</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;================================================================================</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;If SDL is compiled with SDL_ANDROID_BLOCK_ON_PAUSE defined (the default),</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;the event loop will block itself when the app is paused (ie, when the user</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;returns to the main Android dashboard). Blocking is better in terms of battery</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;use, and it allows your app to spring back to life instantaneously after resume</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;(versus polling for a resume message).</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;Upon resume, SDL will attempt to restore the GL context automatically.</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;In modern devices (Android 3.0 and up) this will most likely succeed and your</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;app can continue to operate as it was.</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;However, there&#39;s a chance (on older hardware, or on systems under heavy load),</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;where the GL context can not be restored. In that case you have to listen for</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;a specific message, (which is not yet implemented!) and restore your textures</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;manually or quit the app (which is actually the kind of behaviour you&#39;ll see</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;under iOS, if the OS can not restore your GL context it will just kill your app)</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;================================================================================</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; Threads and the Java VM</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;================================================================================</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;For a quick tour on how Linux native threads interoperate with the Java VM, take</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;a look here: https://developer.android.com/guide/practices/jni.html</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;If you want to use threads in your SDL app, it&#39;s strongly recommended that you</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;do so by creating them using SDL functions. This way, the required attach/detach</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;handling is managed by SDL automagically. If you have threads created by other</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;means and they make calls to SDL functions, make sure that you call</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;Android_JNI_SetupThread() before doing anything else otherwise SDL will attach</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;your thread automatically anyway (when you make an SDL call), but it&#39;ll never</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;detach it.</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;================================================================================</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; Using STL</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;================================================================================</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;You can use STL in your project by creating an Application.mk file in the jni</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;folder and adding the following line:</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    APP_STL := stlport_static</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;For more information check out CPLUSPLUS-SUPPORT.html in the NDK documentation.</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;================================================================================</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; Additional documentation</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;================================================================================</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;The documentation in the NDK docs directory is very helpful in understanding the</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;build process and how to work with native code on the Android platform.</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;The best place to start is with docs/OVERVIEW.TXT</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;================================================================================</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; Using Android Studio</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;================================================================================</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;You can open your project directory with Android Studio and run it normally.</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;================================================================================</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; Using the emulator</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;================================================================================</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;There are some good tips and tricks for getting the most out of the</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;emulator here: https://developer.android.com/tools/devices/emulator.html</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;Especially useful is the info on setting up OpenGL ES 2.0 emulation.</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;Notice that this software emulator is incredibly slow and needs a lot of disk space.</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;Using a real device works better.</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;================================================================================</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; Troubleshooting</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;================================================================================</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;You can see if adb can see any devices with the following command:</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    adb devices</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;You can see the output of log messages on the default device with:</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    adb logcat</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;You can push files to the device with:</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    adb push local_file remote_path_and_file</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;You can push files to the SD Card at /sdcard, for example:</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    adb push moose.dat /sdcard/moose.dat</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;You can see the files on the SD card with a shell command:</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    adb shell ls /sdcard/</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;You can start a command shell on the default device with:</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    adb shell</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;You can remove the library files of your project (and not the SDL lib files) with:</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    ndk-build clean</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;You can do a build with the following command:</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    ndk-build</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;You can see the complete command line that ndk-build is using by passing V=1 on the command line:</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    ndk-build V=1</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;If your application crashes in native code, you can use addr2line to convert the</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;addresses in the stack trace to lines in your code.</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;For example, if your crash looks like this:</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    I/DEBUG   (   31): signal 11 (SIGSEGV), code 2 (SEGV_ACCERR), fault addr 400085d0</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    I/DEBUG   (   31):  r0 00000000  r1 00001000  r2 00000003  r3 400085d4</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    I/DEBUG   (   31):  r4 400085d0  r5 40008000  r6 afd41504  r7 436c6a7c</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    I/DEBUG   (   31):  r8 436c6b30  r9 435c6fb0  10 435c6f9c  fp 4168d82c</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    I/DEBUG   (   31):  ip 8346aff0  sp 436c6a60  lr afd1c8ff  pc afd1c902  cpsr 60000030</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    I/DEBUG   (   31):          #00  pc 0001c902  /system/lib/libc.so</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    I/DEBUG   (   31):          #01  pc 0001ccf6  /system/lib/libc.so</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    I/DEBUG   (   31):          #02  pc 000014bc  /data/data/org.libsdl.app/lib/libmain.so</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    I/DEBUG   (   31):          #03  pc 00001506  /data/data/org.libsdl.app/lib/libmain.so</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;You can see that there&#39;s a crash in the C library being called from the main code.</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;I run addr2line with the debug version of my code:</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    arm-eabi-addr2line -C -f -e obj/local/armeabi/libmain.so</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;and then paste in the number after &quot;pc&quot; in the call stack, from the line that I care about:</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;000014bc</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;I get output from addr2line showing that it&#39;s in the quit function, in testspriteminimal.c, on line 23.</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;You can add logging to your code to help show what&#39;s happening:</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    #include &lt;android/log.h&gt;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    </div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    __android_log_print(ANDROID_LOG_INFO, &quot;foo&quot;, &quot;Something happened! x = %d&quot;, x);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;If you need to build without optimization turned on, you can create a file called</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;&quot;Application.mk&quot; in the jni directory, with the following line in it:</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    APP_OPTIM := debug</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;================================================================================</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; Memory debugging</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;================================================================================</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;The best (and slowest) way to debug memory issues on Android is valgrind.</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;Valgrind has support for Android out of the box, just grab code using:</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    svn co svn://svn.valgrind.org/valgrind/trunk valgrind</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;... and follow the instructions in the file README.android to build it.</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;One thing I needed to do on Mac OS X was change the path to the toolchain,</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;and add ranlib to the environment variables:</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;export RANLIB=$NDKROOT/toolchains/arm-linux-androideabi-4.4.3/prebuilt/darwin-x86/bin/arm-linux-androideabi-ranlib</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;Once valgrind is built, you can create a wrapper script to launch your</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;application with it, changing org.libsdl.app to your package identifier:</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    --- start_valgrind_app -------------------</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    #!/system/bin/sh</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    export TMPDIR=/data/data/org.libsdl.app</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    exec /data/local/Inst/bin/valgrind --log-file=/sdcard/valgrind.log --error-limit=no $*</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    ------------------------------------------</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;Then push it to the device:</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    adb push start_valgrind_app /data/local</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;and make it executable:</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    adb shell chmod 755 /data/local/start_valgrind_app</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;and tell Android to use the script to launch your application:</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    adb shell setprop wrap.org.libsdl.app &quot;logwrapper /data/local/start_valgrind_app&quot;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;If the setprop command says &quot;could not set property&quot;, it&#39;s likely that</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;your package name is too long and you should make it shorter by changing</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;AndroidManifest.xml and the path to your class file in android-project/src</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;You can then launch your application normally and waaaaaaaiiittt for it.</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;You can monitor the startup process with the logcat command above, and</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;when it&#39;s done (or even while it&#39;s running) you can grab the valgrind</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;output file:</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    adb pull /sdcard/valgrind.log</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;When you&#39;re done instrumenting with valgrind, you can disable the wrapper:</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    adb shell setprop wrap.org.libsdl.app &quot;&quot;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;================================================================================</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; Graphics debugging</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;================================================================================</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;If you are developing on a compatible Tegra-based tablet, NVidia provides</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;Tegra Graphics Debugger at their website. Because SDL2 dynamically loads EGL</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;and GLES libraries, you must follow their instructions for installing the</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;interposer library on a rooted device. The non-rooted instructions are not</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;compatible with applications that use SDL2 for video.</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;The Tegra Graphics Debugger is available from NVidia here:</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;https://developer.nvidia.com/tegra-graphics-debugger</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;================================================================================</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; Why is API level 14 the minimum required?</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;================================================================================</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;The latest NDK toolchain doesn&#39;t support targeting earlier than API level 14.</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;As of this writing, according to https://developer.android.com/about/dashboards/index.html</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;about 99% of the Android devices accessing Google Play support API level 14 or</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;higher (October 2017).</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;================================================================================</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; A note regarding the use of the &quot;dirty rectangles&quot; rendering technique</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;================================================================================</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;If your app uses a variation of the &quot;dirty rectangles&quot; rendering technique,</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;where you only update a portion of the screen on each frame, you may notice a</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;variety of visual glitches on Android, that are not present on other platforms.</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;This is caused by SDL&#39;s use of EGL as the support system to handle OpenGL ES/ES2</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;contexts, in particular the use of the eglSwapBuffers function. As stated in the</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;documentation for the function &quot;The contents of ancillary buffers are always </div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;undefined after calling eglSwapBuffers&quot;.</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;Setting the EGL_SWAP_BEHAVIOR attribute of the surface to EGL_BUFFER_PRESERVED</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;is not possible for SDL as it requires EGL 1.4, available only on the API level</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;17+, so the only workaround available on this platform is to redraw the entire</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;screen each frame.</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;Reference: http://www.khronos.org/registry/egl/specs/EGLTechNote0001.html</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;================================================================================</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; Known issues</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;================================================================================</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;- The number of buttons reported for each joystick is hardcoded to be 36, which</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;is the current maximum number of buttons Android can report.</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div></div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
